/**
 * AWS Bedrock model provider implementation.
 *
 * This module provides integration with AWS Bedrock's Converse API,
 * supporting streaming responses, tool use, and prompt caching.
 *
 * @see https://docs.aws.amazon.com/bedrock/latest/APIReference/API_runtime_ConverseStream.html
 */
import { type BedrockRuntimeClientConfig } from '@aws-sdk/client-bedrock-runtime';
import { type BaseModelConfig, Model, type StreamOptions } from '../models/model.js';
import type { Message } from '../types/messages.js';
import type { ModelStreamEvent } from '../models/streaming.js';
import type { JSONValue } from '../types/json.js';
/**
 * Configuration interface for AWS Bedrock model provider.
 *
 * Extends BaseModelConfig with Bedrock-specific configuration options
 * for model parameters, caching, and additional request/response fields.
 *
 * @example
 * ```typescript
 * const config: BedrockModelConfig = {
 *   modelId: 'global.anthropic.claude-sonnet-4-5-20250929-v1:0',
 *   maxTokens: 1024,
 *   temperature: 0.7,
 *   cachePrompt: 'ephemeral'
 * }
 * ```
 */
export interface BedrockModelConfig extends BaseModelConfig {
    /**
     * Maximum number of tokens to generate in the response.
     *
     * @see https://docs.aws.amazon.com/bedrock/latest/APIReference/API_runtime_InferenceConfiguration.html
     */
    maxTokens?: number;
    /**
     * Controls randomness in generation.
     *
     * @see https://docs.aws.amazon.com/bedrock/latest/APIReference/API_runtime_InferenceConfiguration.html
     */
    temperature?: number;
    /**
     * Controls diversity via nucleus sampling.
     *
     * @see https://docs.aws.amazon.com/bedrock/latest/APIReference/API_runtime_InferenceConfiguration.html
     */
    topP?: number;
    /**
     * Array of sequences that will stop generation when encountered.
     */
    stopSequences?: string[];
    /**
     * Cache point type for the system prompt.
     * @see https://docs.aws.amazon.com/bedrock/latest/userguide/prompt-caching.html
     */
    cachePrompt?: string;
    /**
     * Cache point type for tools.
     * @see https://docs.aws.amazon.com/bedrock/latest/userguide/prompt-caching.html
     */
    cacheTools?: string;
    /**
     * Additional fields to include in the Bedrock request.
     */
    additionalRequestFields?: JSONValue;
    /**
     * Additional response field paths to extract from the Bedrock response.
     */
    additionalResponseFieldPaths?: string[];
    /**
     * Additional arguments to pass through to the Bedrock Converse API.
     * @see https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/client/bedrock-runtime/command/ConverseStreamCommand/
     */
    additionalArgs?: JSONValue;
    /**
     * Whether or not to stream responses from the model.
     *
     * This will use the ConverseStream API instead of the Converse API.
     *
     * @see https://docs.aws.amazon.com/bedrock/latest/APIReference/API_runtime_Converse.html
     * @see https://docs.aws.amazon.com/bedrock/latest/APIReference/API_runtime_ConverseStream.html
     */
    stream?: boolean;
    /**
     * Flag to include status field in tool results.
     * - `true`: Always include status field
     * - `false`: Never include status field
     * - `'auto'`: Automatically determine based on model ID (default)
     */
    includeToolResultStatus?: 'auto' | boolean;
}
/**
 * Options for creating a BedrockModel instance.
 */
export interface BedrockModelOptions extends BedrockModelConfig {
    /**
     * AWS region to use for the Bedrock service.
     */
    region?: string;
    /**
     * Configuration for the Bedrock Runtime client.
     */
    clientConfig?: BedrockRuntimeClientConfig;
}
/**
 * AWS Bedrock model provider implementation.
 *
 * Implements the Model interface for AWS Bedrock using the Converse Stream API.
 * Supports streaming responses, tool use, prompt caching, and comprehensive error handling.
 *
 * @example
 * ```typescript
 * const provider = new BedrockModel({
 *   modelConfig: {
 *     modelId: 'global.anthropic.claude-sonnet-4-5-20250929-v1:0',
 *     maxTokens: 1024,
 *     temperature: 0.7
 *   },
 *   clientConfig: {
 *     region: 'us-west-2'
 *   }
 * })
 *
 * const messages: Message[] = [
 *   { type: 'message', role: 'user', content: [{ type: 'textBlock', text: 'Hello!' }] }
 * ]
 *
 * for await (const event of provider.stream(messages)) {
 *   if (event.type === 'modelContentBlockDeltaEvent' && event.delta.type === 'textDelta') {
 *     process.stdout.write(event.delta.text)
 *   }
 * }
 * ```
 */
export declare class BedrockModel extends Model<BedrockModelConfig> {
    private _config;
    private _client;
    /**
     * Creates a new BedrockModel instance.
     *
     * @param options - Optional configuration for model and client
     *
     * @example
     * ```typescript
     * // Minimal configuration with defaults
     * const provider = new BedrockModel({
     *   region: 'us-west-2'
     * })
     *
     * // With model configuration
     * const provider = new BedrockModel({
     *   region: 'us-west-2',
     *   modelId: 'global.anthropic.claude-sonnet-4-5-20250929-v1:0',
     *   maxTokens: 2048,
     *   temperature: 0.8,
     *   cachePrompt: 'ephemeral'
     * })
     *
     * // With client configuration
     * const provider = new BedrockModel({
     *   region: 'us-east-1',
     *   clientConfig: {
     *     credentials: myCredentials
     *   }
     * })
     * ```
     */
    constructor(options?: BedrockModelOptions);
    /**
     * Updates the model configuration.
     * Merges the provided configuration with existing settings.
     *
     * @param modelConfig - Configuration object with model-specific settings to update
     *
     * @example
     * ```typescript
     * // Update temperature and maxTokens
     * provider.updateConfig({
     *   temperature: 0.9,
     *   maxTokens: 2048
     * })
     * ```
     */
    updateConfig(modelConfig: BedrockModelConfig): void;
    /**
     * Retrieves the current model configuration.
     *
     * @returns The current configuration object
     *
     * @example
     * ```typescript
     * const config = provider.getConfig()
     * console.log(config.modelId)
     * ```
     */
    getConfig(): BedrockModelConfig;
    /**
     * Streams a conversation with the Bedrock model.
     * Returns an async iterable that yields streaming events as they occur.
     *
     * @param messages - Array of conversation messages
     * @param options - Optional streaming configuration
     * @returns Async iterable of streaming events
     *
     * @throws \{ContextWindowOverflowError\} When input exceeds the model's context window
     * @throws \{ModelThrottledError\} When Bedrock service throttles requests
     *
     * @example
     * ```typescript
     * const messages: Message[] = [
     *   { type: 'message', role: $1, content: [{ type: 'textBlock', text: 'What is 2+2?' }] }
     * ]
     *
     * const options: StreamOptions = {
     *   systemPrompt: 'You are a helpful math assistant.',
     *   toolSpecs: [calculatorTool]
     * }
     *
     * for await (const event of provider.stream(messages, options)) {
     *   if (event.type === 'modelContentBlockDeltaEvent') {
     *     console.log(event.delta)
     *   }
     * }
     * ```
     */
    stream(messages: Message[], options?: StreamOptions): AsyncIterable<ModelStreamEvent>;
    /**
     * Formats a request for the Bedrock Converse Stream API.
     *
     * @param messages - Conversation messages
     * @param options - Stream options
     * @returns Formatted Bedrock request
     */
    private _formatRequest;
    /**
     * Formats messages for Bedrock API.
     *
     * @param messages - SDK messages
     * @returns Bedrock-formatted messages
     */
    private _formatMessages;
    /**
     * Determines whether to include the status field in tool results.
     *
     * Uses the includeToolResultStatus config option:
     * - If explicitly true, always include status
     * - If explicitly false, never include status
     * - If 'auto' (default), check if model ID matches known patterns
     *
     * @returns True if status field should be included, false otherwise
     */
    private _shouldIncludeToolResultStatus;
    /**
     * Formats a content block for Bedrock API.
     *
     * @param block - SDK content block
     * @returns Bedrock-formatted content block
     */
    private _formatContentBlock;
    /**
     * Format media source (image/video) for Bedrock API.
     * Handles bytes, S3 locations, and s3:// URLs.
     *
     * @param source - Media source
     * @returns Formatted source for Bedrock API
     */
    private _formatMediaSource;
    /**
     * Format document source for Bedrock API.
     * Handles bytes, text, content, and S3 locations.
     * Note: Bedrock API only accepts bytes, content, or s3Location - text is converted to bytes.
     *
     * @param source - Document source
     * @returns Formatted source for Bedrock API
     */
    private _formatDocumentSource;
    private _mapBedrockEventToSDKEvent;
    /**
     * Maps a Bedrock event to SDK streaming events.
     *
     * @param chunk - Bedrock event chunk
     * @returns Array of SDK streaming events
     */
    private _mapStreamedBedrockEventToSDKEvent;
    /**
     * Transforms a Bedrock stop reason into the SDK's format.
     *
     * @param stopReasonRaw - The raw stop reason string from Bedrock.
     * @param event - The full event output, used to check for tool_use adjustments.
     * @returns The transformed stop reason string.
     */
    private _transformStopReason;
}
//# sourceMappingURL=bedrock.d.ts.map